<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2020-12-29 Tue 19:19 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Arch Linux Installation Log</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Nancy" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet"
                     href="../assets/style.css"
                     type="text/css"/>
                     <link href="https://fonts.googleapis.com/css?family=Domine:wght@500&display=swap"
                     rel="stylesheet"
                     type="text/css"/>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
</head>
<body>
<div id="content">
<h1 class="title">Arch Linux Installation Log</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org2408569">Base installation</a>
<ul>
<li><a href="#orga64c3c3">Prepare installation media</a></li>
<li><a href="#org9e30d58">Boot</a></li>
<li><a href="#orgd1aa2d4">Set keyboard layout</a></li>
<li><a href="#orga22ee84">Verify UEFI boot</a></li>
<li><a href="#org17e2935">Verify network connection</a></li>
<li><a href="#org5d227af">Set system clock</a></li>
<li><a href="#org88ca6e2">Identify target drive</a></li>
<li><a href="#orgb908f88">Determine desired partitioning scheme</a></li>
<li><a href="#orgbd6ff3b">Partition the disk</a></li>
<li><a href="#orgdf69334">Format the filesystems</a></li>
<li><a href="#orgff80a65">Mount the file systems</a></li>
<li><a href="#org3a63362">Sort the Pacman mirrors</a></li>
<li><a href="#orgf094069">Install the base system</a></li>
</ul>
</li>
<li><a href="#org2b35c47">Initial configuration</a>
<ul>
<li><a href="#orgfc0c265">Generate fstab</a></li>
<li><a href="#org2e72a49">Chroot</a></li>
<li><a href="#org5bc4117">Set timezone</a></li>
<li><a href="#org0a590bf">Set locale</a></li>
<li><a href="#org64709e4">Set hostname</a></li>
<li><a href="#org7cfe3f1">Set root password</a></li>
<li><a href="#org7979f33">Microcode</a></li>
<li><a href="#org89072a6">Bootloader</a></li>
<li><a href="#orgcc862d0">Reboot</a></li>
<li><a href="#orgcd56cc2">Emergency shell</a></li>
</ul>
</li>
<li><a href="#orgb6ebe85">Post installation</a>
<ul>
<li><a href="#org0b3911c">Verify microcode</a></li>
<li><a href="#org98a7176">Setup network</a></li>
<li><a href="#org10d0d4e">Create a user</a></li>
<li><a href="#org3911591">Configure <code>sudo</code></a></li>
<li><a href="#orgafde7c5">Configure PAM</a></li>
<li><a href="#org2604bf7">Add <code>~/bin</code> to <code>PATH</code> globally</a></li>
<li><a href="#orgf1c525a">Setup <code>udiskctl</code></a></li>
<li><a href="#orgddc0789">Make numlock active on boot</a></li>
<li><a href="#org98573ef">Configure fonts</a></li>
<li><a href="#orgea81656">Sync my dotfiles</a></li>
<li><a href="#org3e6e793">Sync my org files</a></li>
<li><a href="#orgb668267">Setup Anki</a></li>
<li><a href="#org4df24b8">Install software</a></li>
<li><a href="#org22c2d6f">Setup Fluidsynth daemon</a></li>
</ul>
</li>
</ul>
</div>
</div>
<p>
I have instaled Arch Linux many many times, but I&rsquo;ve never made a log of the process. So I&rsquo;ll do that this time! This way I can maybe refine the process and tweaks I like to make and stuff :o
</p>

<p>
I&rsquo;m doing this because my SSD died, so I got a new one and time for a fresh installation XD
</p>

<p>
I&rsquo;m using the 2020 December 1st istallation ISO!
</p>

<p>
And I&rsquo;m installing on my 6600K machine.
</p>

<p>
And I&rsquo;ll be following along with the <a href="https://wiki.archlinux.org/index.php/installation_guide">installation guide</a>!
</p>

<p>
Even though I have this guide to guide myself through future insallations, I should still check the wiki for any up-to-date information.
</p>

<p>
I am contemplating making a fresh install image I can just copy over&#x2026;.. but I&rsquo;m not sure&#x2026;.. it&rsquo;s kinda nice doing a truly fresh installation each time I think&#x2026;.. :o
</p>

<div id="outline-container-org2408569" class="outline-2">
<h2 id="org2408569">Base installation</h2>
<div class="outline-text-2" id="text-org2408569">
</div>
<div id="outline-container-orga64c3c3" class="outline-3">
<h3 id="orga64c3c3">Prepare installation media</h3>
<div class="outline-text-3" id="text-orga64c3c3">
<p>
I gotta download the latest ISO and copy it using <code>dd</code> to a USB drive!
</p>
</div>
</div>
<div id="outline-container-org9e30d58" class="outline-3">
<h3 id="org9e30d58">Boot</h3>
<div class="outline-text-3" id="text-org9e30d58">
<p>
Booting from the EFI loader on the USB drive!
</p>
</div>
</div>
<div id="outline-container-orgd1aa2d4" class="outline-3">
<h3 id="orgd1aa2d4">Set keyboard layout</h3>
<div class="outline-text-3" id="text-orgd1aa2d4">
<p>
I use Dvorak as my main layout, so <code>loadkeys dvorak</code>
</p>
</div>
</div>
<div id="outline-container-orga22ee84" class="outline-3">
<h3 id="orga22ee84">Verify UEFI boot</h3>
<div class="outline-text-3" id="text-orga22ee84">
<p>
Make sure this exists: <code>ls /sys/firmware/efi/efivars</code>
</p>
</div>
</div>
<div id="outline-container-org17e2935" class="outline-3">
<h3 id="org17e2935">Verify network connection</h3>
<div class="outline-text-3" id="text-org17e2935">
<p>
I&rsquo;m using ethernet, which should work automatically. I usually just verify this by pinging Google, lol: <code>ping google.com</code>
</p>
</div>
</div>
<div id="outline-container-org5d227af" class="outline-3">
<h3 id="org5d227af">Set system clock</h3>
<div class="outline-text-3" id="text-org5d227af">
<p>
Enable network time protocol: <code>timedatectl set-ntp true</code>
</p>

<p>
Verify: <code>timedatectl status</code>
</p>
</div>
</div>
<div id="outline-container-org88ca6e2" class="outline-3">
<h3 id="org88ca6e2">Identify target drive</h3>
<div class="outline-text-3" id="text-org88ca6e2">
<p>
I have several drives connected to the motherboard, so I want to make sure I&rsquo;m installing to the correct drive, and not overwriting another one! <code>0_0</code>
</p>

<p>
I look at the drives: <code>lsblk</code>
</p>

<p>
And I know that my new SSD is 240GB and should be uninitialized. So I see that <code>sdc</code> has no partitions and is the only drive that shows up as 223.6G, so I know <code>sdc</code> is the target!
</p>
</div>
</div>
<div id="outline-container-orgb908f88" class="outline-3">
<h3 id="orgb908f88">Determine desired partitioning scheme</h3>
<div class="outline-text-3" id="text-orgb908f88">
<p>
There are several good arguments for splitting up the drive into several different partitions, but in my own experience, it&rsquo;s not worth the hassle of running out of space in one partition and wishing I could shrink another partition to make more room. And really, I&rsquo;ve never had problems with using one big partition, so that&rsquo;s what I&rsquo;m going to stick with lol. I&rsquo;m not worried about rogue processes running amok on a partition eating things up. I mean, even if it happened, I keep most of my stuff backed up and easily syncable.
</p>

<p>
So! My partition scheme is simple:
</p>
<dl class="org-dl">
<dt><code>/boot</code></dt><dd>1 GB</dd>
<dt>Swap</dt><dd>4 GB</dd>
<dt><code>/</code></dt><dd>Remainder</dd>
</dl>

<p>
Note that I don&rsquo;t care about hibernation. If I did, then I&rsquo;d need to make my swap partition &gt; 16 GB since thats how much RAM I have installed.
</p>

<p>
The reason I put a swap partition despite having 16 GB of RAM is simple because, in my experience, running out of memory doesn&rsquo;t go so well, lol. The whole system usually comes to a halt and it&rsquo;s extremely difficult to fix&#x2026; I rather there be a little bit of a buffer before I run out of memory so I can close some processes without having to hard reboot!
</p>
</div>
</div>
<div id="outline-container-orgbd6ff3b" class="outline-3">
<h3 id="orgbd6ff3b">Partition the disk</h3>
<div class="outline-text-3" id="text-orgbd6ff3b">
<p>
Now that I know what scheme I want, I actually partition the disk: <code>fdisk /dev/sdc</code>
</p>
<ol class="org-ol">
<li>Create a new empty GPT partition table</li>
<li>Add a new partition
<ul class="org-ul">
<li>Default partition number</li>
<li>Default first sector</li>
<li><code>+1G</code> for last sector</li>
<li>Set patition type to alias <code>uefi</code></li>
</ul></li>
<li>Add a new partition
<ul class="org-ul">
<li>Default partition number</li>
<li>Default first sector</li>
<li><code>+4G</code> for last sector</li>
<li>Set patition type to alias <code>swap</code></li>
</ul></li>
<li>Add a new partition
<ul class="org-ul">
<li>Default partition number</li>
<li>Default first sector</li>
<li>Default last sector (remainder of device)</li>
<li>Set patition type to alias <code>linux</code></li>
</ul></li>
<li>Write table to disk and exit</li>
</ol>

<p>
If I look at <code>lsblk</code> again, I can see that <code>sdc</code> now has the three partitions I just created!
</p>
</div>
</div>

<div id="outline-container-orgdf69334" class="outline-3">
<h3 id="orgdf69334">Format the filesystems</h3>
<div class="outline-text-3" id="text-orgdf69334">
<p>
I&rsquo;ll format the UEFI partition as FAT32: <code>mkfs.fat -F32 /dev/sdc1</code>
</p>

<p>
The swap partition as swap of course: <code>mkswap /dev/sdc2</code>
</p>

<p>
And the root partition as EXT4: <code>mkfs.ext4 /dev/sdc3</code>
</p>
</div>
</div>
<div id="outline-container-orgff80a65" class="outline-3">
<h3 id="orgff80a65">Mount the file systems</h3>
<div class="outline-text-3" id="text-orgff80a65">
<p>
Now to mount the file systems to their respective relative mount points so that we can chroot into it and install the system!
</p>

<p>
Mount the root partition to <code>/mnt</code>: <code>mount /dev/sdc3 /mnt</code>
</p>

<p>
I&rsquo;m going to call the mountpoint for the boot partition <code>boot</code> instead of something else (like <code>efi</code>) because uh&#x2026;.. something to do with using EFISTUB.
</p>

<p>
Create the mountpoint for the boot partition: <code>mkdir /mnt/boot</code>
</p>

<p>
Mount the boot partition to <code>/mnt/efi</code>: <code>mount /dev/sdc3 /mnt/boot</code>
</p>

<p>
Enable the swap (so the fstab generation detects it later): <code>swapon /dev/sdc2</code>
</p>
</div>
</div>
<div id="outline-container-org3a63362" class="outline-3">
<h3 id="org3a63362">Sort the Pacman mirrors</h3>
<div class="outline-text-3" id="text-org3a63362">
<p>
<code>reflector --verbose --latest 20 --sort rate --save /etc/pacman.d/mirrorlist</code>
</p>
</div>
</div>
<div id="outline-container-orgf094069" class="outline-3">
<h3 id="orgf094069">Install the base system</h3>
<div class="outline-text-3" id="text-orgf094069">
<p>
<code>pacstrap /mnt base linux linux-firmware vim efibootmgr</code>
</p>
</div>
</div>
</div>
<div id="outline-container-org2b35c47" class="outline-2">
<h2 id="org2b35c47">Initial configuration</h2>
<div class="outline-text-2" id="text-org2b35c47">
</div>
<div id="outline-container-orgfc0c265" class="outline-3">
<h3 id="orgfc0c265">Generate fstab</h3>
<div class="outline-text-3" id="text-orgfc0c265">
<p>
<code>genfstab -U /mnt &gt;&gt; /mnt/etc/fstab</code>
</p>
</div>
</div>
<div id="outline-container-org2e72a49" class="outline-3">
<h3 id="org2e72a49">Chroot</h3>
<div class="outline-text-3" id="text-org2e72a49">
<p>
<code>arch-chroot /mnt</code>
</p>
</div>
</div>
<div id="outline-container-org5bc4117" class="outline-3">
<h3 id="org5bc4117">Set timezone</h3>
<div class="outline-text-3" id="text-org5bc4117">
<p>
I&rsquo;m in central time zone so!
<code>ln -sf /usr/share/zoneinfo/US/Central /etc/localtime</code>
</p>

<p>
And <code>hwclock --systohc</code>
</p>
</div>
</div>

<div id="outline-container-org0a590bf" class="outline-3">
<h3 id="org0a590bf">Set locale</h3>
<div class="outline-text-3" id="text-org0a590bf">
<p>
As much as I love other languages, English is just the most practical language for technology stuff, so I will just set the US English locale for now lol: <code>vim /etc/locale.gen</code> and uncomment <code>en_US.UTF-8 UTF-8</code>
</p>

<p>
Then: <code>locale-gen</code>
</p>

<p>
And: <code>echo "LANG=en_US.UTF-8" &gt; /etc/locale.conf</code>
</p>

<p>
And make the virtual console keyboard layout consistent: <code>echo "KEYMAP=dvorak" &gt; /etc/vconsole.conf</code>
</p>
</div>
</div>

<div id="outline-container-org64709e4" class="outline-3">
<h3 id="org64709e4">Set hostname</h3>
<div class="outline-text-3" id="text-org64709e4">
<p>
<code>echo "cheesy-6600k" &gt; /etc/hostname</code>
</p>

<p>
And edit <code>/etc/hosts</code> to contain:
</p>
<pre class="example">
127.0.0.1   localhost
::1         localhost
127.0.1.1   cheesy-6600k.localdomain    cheesy-6600k
</pre>
</div>
</div>

<div id="outline-container-org7cfe3f1" class="outline-3">
<h3 id="org7cfe3f1">Set root password</h3>
<div class="outline-text-3" id="text-org7cfe3f1">
<p>
<code>passwd</code>
</p>
</div>
</div>

<div id="outline-container-org7979f33" class="outline-3">
<h3 id="org7979f33">Microcode</h3>
<div class="outline-text-3" id="text-org7979f33">
<p>
I use an Intel processor so do <code>pacman -S intel-ucode</code>
</p>

<p>
And it&rsquo;ll be added to the boot options below.
</p>
</div>
</div>

<div id="outline-container-org89072a6" class="outline-3">
<h3 id="org89072a6">Bootloader</h3>
<div class="outline-text-3" id="text-org89072a6">
<p>
I like to use the EFISTUB method, which boots the kernel directly as an EFI executable.
</p>

<p>
See the current EFI entries using <code>efibootmgr</code>.
</p>

<p>
Delete any unneeded entries using <code>efibootmgr -B -b 0</code> (replace <code>0</code> with the corresponding hex for the entry).
</p>

<p>
Find the UUIDs for the partitions: <code>ls -l /dev/disk/by-uuid/</code>
</p>

<p>
Painstakigly replace the X&rsquo;s (represents ROOT partition, which, in this case is <code>sdc3</code>) (and change <code>sdc</code> and <code>--part 1</code> if using a different device and/or partition for BOOT!!!!!) in this command and run it: <code>efibootmgr --disk /dev/sdc --part 1 --create --label "Arch Linux" --loader /vmlinuz-linux --unicode 'root=UUID=XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX rw initrd=\intel-ucode.img initrd=\initramfs-linux.img' --verbose</code>
</p>

<p>
BEWARE! The wiki say to use &rsquo;root=PARTUUID=&#x2026;&rsquo; instead of &rsquo;UUID&rsquo;&#x2026;.. but this is wrong!!!!
</p>

<p>
Make it active: <code>efibootmgr -a -b 0</code> (Replace <code>0</code> with the bootnum of the entry just created.)
</p>

<p>
Set the boot order: <code>efibootmgr --bootorder 0000,0001 --verbose</code> (Again replace the <code>0000</code> and <code>0001</code> with the ordering of whatever entries you want for boot priority.)
</p>
</div>
</div>

<div id="outline-container-orgcc862d0" class="outline-3">
<h3 id="orgcc862d0">Reboot</h3>
<div class="outline-text-3" id="text-orgcc862d0">
<p>
Time to make sure everything works properly!
</p>

<p>
(If it doesn&rsquo;t just boot back into the installation USB and troubleshoot.)
</p>

<p>
Press <code>^d</code> to get out of the chroot environment, and then unmount all the filesystems: <code>umount /mnt/boot &amp;&amp; umount /mnt</code>
</p>

<p>
Reboot!: <code>reboot</code>
</p>
</div>
</div>

<div id="outline-container-orgcd56cc2" class="outline-3">
<h3 id="orgcd56cc2">Emergency shell</h3>
<div class="outline-text-3" id="text-orgcd56cc2">
<p>
Here&rsquo;s what to do if things didn&rsquo;t go as planned and you get dropped into the emergency shell:
</p>

<p>
First mount the root file system: <code>mount /dev/sdc3 new_root</code>
</p>

<p>
And then exit: <code>exit</code>
</p>

<p>
Now you should be booting into the system! So just troubleshoot from there!
</p>
</div>
</div>
</div>

<div id="outline-container-orgb6ebe85" class="outline-2">
<h2 id="orgb6ebe85">Post installation</h2>
<div class="outline-text-2" id="text-orgb6ebe85">
<p>
If you can now successfully boot into the new system, now time to configure stuff!!
</p>

<p>
First login as <code>root</code> with the password you set.
</p>
</div>

<div id="outline-container-org0b3911c" class="outline-3">
<h3 id="org0b3911c">Verify microcode</h3>
<div class="outline-text-3" id="text-org0b3911c">
<p>
<code>dmesg | grep microcode</code> and it should say &ldquo;microcode updated early&#x2026;&rdquo;
</p>
</div>
</div>

<div id="outline-container-org98a7176" class="outline-3">
<h3 id="org98a7176">Setup network</h3>
<div class="outline-text-3" id="text-org98a7176">
<p>
Create the file <code>/etc/systemd/network/20-ethernet.network</code> containing:
</p>
<pre class="example">
[Match]
Name=en*
Name=eth*

[Network]
DHCP=yes
</pre>

<p>
Enable the <code>systemd-networkd</code> service: <code>systemctl enable systemd-networkd</code>
</p>

<p>
Enable the <code>systemd-resolved</code> service: <code>systemctl enable systemd-resolved</code>
</p>

<p>
Reboot to verify that it connects on boot!
</p>
</div>
</div>

<div id="outline-container-org10d0d4e" class="outline-3">
<h3 id="org10d0d4e">Create a user</h3>
<div class="outline-text-3" id="text-org10d0d4e">
<p>
First create the user: <code>useradd -m -G video,input,audio,wheel -s /bin/bash nancy</code>
</p>

<p>
Set the passwd for the user: <code>passwd nancy</code>
</p>

<p>
Then copy over my home directory stuff somehow or another. I&rsquo;m hosting a tar file over http (using <code>python -m http.server</code>) and grabbing it via <code>wget</code>. But do whatever!
</p>
</div>
</div>

<div id="outline-container-org3911591" class="outline-3">
<h3 id="org3911591">Configure <code>sudo</code></h3>
<div class="outline-text-3" id="text-org3911591">
<p>
Install sudo: <code>pacman -S sudo</code>
</p>

<p>
Run <code>visudo</code> and uncomment the line <code>%wheel ALL=(ALL) ALL</code> and save and exit.
</p>

<p>
At this point it&rsquo;s a good idea to exit root and login as the new fresh user! :3
</p>
</div>
</div>

<div id="outline-container-orgafde7c5" class="outline-3">
<h3 id="orgafde7c5">Configure PAM</h3>
<div class="outline-text-3" id="text-orgafde7c5">
<p>
The reason I do this is because I can&rsquo;t stand the long wait when I mistype a password lol.
</p>

<p>
Replace <code>/etc/pam.d/system-auth</code> with this:
</p>

<pre class="example">
#%PAM-1.0

auth      required  pam_unix.so     try_first_pass nullok nodelay
auth      optional  pam_permit.so
auth      required  pam_env.so

account   required  pam_unix.so
account   optional  pam_permit.so
account   required  pam_time.so

password  required  pam_unix.so     try_first_pass nullok sha512 shadow
password  optional  pam_permit.so

session   required  pam_limits.so
session   required  pam_unix.so
session   optional  pam_permit.so
</pre>
</div>
</div>

<div id="outline-container-org2604bf7" class="outline-3">
<h3 id="org2604bf7">Add <code>~/bin</code> to <code>PATH</code> globally</h3>
<div class="outline-text-3" id="text-org2604bf7">
<p>
Open (with root) <code>/etc/profile</code> and add the following:
</p>

<pre class="example">
# User home bin directory
export PATH="$HOME/bin:$PATH"
</pre>
</div>
</div>

<div id="outline-container-orgf1c525a" class="outline-3">
<h3 id="orgf1c525a">Setup <code>udiskctl</code></h3>
<div class="outline-text-3" id="text-orgf1c525a">
<p>
Install <code>udisks2</code> and <code>ntfs-3g</code>.
</p>
</div>
</div>

<div id="outline-container-orgddc0789" class="outline-3">
<h3 id="orgddc0789">Make numlock active on boot</h3>
<div class="outline-text-3" id="text-orgddc0789">
<p>
Install this from the AUR: <a href="https://aur.archlinux.org/packages/systemd-numlockontty/">https://aur.archlinux.org/packages/systemd-numlockontty/</a>
</p>

<p>
Enable it like it says when you install it: <code>systemctl enable numLockOnTty</code>
</p>
</div>
</div>

<div id="outline-container-org98573ef" class="outline-3">
<h3 id="org98573ef">Configure fonts</h3>
<div class="outline-text-3" id="text-org98573ef">
<p>
Install <code>ttf-hack</code> and <code>noto-fonts</code> and <code>noto-fonts-emoji</code>. (And some others&#x2026; like CJK fonts&#x2026;)
</p>
</div>
</div>

<div id="outline-container-orgea81656" class="outline-3">
<h3 id="orgea81656">Sync my dotfiles</h3>
<div class="outline-text-3" id="text-orgea81656">
<p>
And remember to install them using hard linking with <code>./install.sh -l</code>
</p>
</div>
</div>

<div id="outline-container-org3e6e793" class="outline-3">
<h3 id="org3e6e793">Sync my org files</h3>
<div class="outline-text-3" id="text-org3e6e793">
<p>
And remember to decrypt with <code>git-crypt unlock org.key</code>
</p>
</div>
</div>

<div id="outline-container-orgb668267" class="outline-3">
<h3 id="orgb668267">Setup Anki</h3>
<div class="outline-text-3" id="text-orgb668267">
<p>
If I don&rsquo;t have an Anki configuration directory to copy from an existing installation, I can setup a new one.
</p>

<p>
Install Anki! <code>pacman -S anki</code>
</p>

<p>
And then add these <a href="20201218125628-anki_plugins.html">plugins</a>.
</p>

<p>
And then sync my decks from ankiweb! Simpel simpel.
</p>
</div>
</div>

<div id="outline-container-org4df24b8" class="outline-3">
<h3 id="org4df24b8">Install software</h3>
<div class="outline-text-3" id="text-org4df24b8">
<p>
I should organize these lol
</p>

<ul class="org-ul">
<li>base-devel</li>
<li>Xorg
<ul class="org-ul">
<li>intel graphics drivers</li>
</ul></li>
<li>pulseaudio
<ul class="org-ul">
<li>pavucontrol</li>
<li>pamixer</li>
</ul></li>
<li>mlocate</li>
<li>rofi</li>
<li>rofimoji</li>
<li>cups</li>
<li>python3</li>
<li>i3</li>
<li>termite</li>
<li>emacs (doom)</li>
<li>discord</li>
<li>firefox</li>
<li>azpainter</li>
<li>Imgbrd-Grabber</li>
<li>feh</li>
<li>mpv</li>
<li>wget</li>
<li>dunst</li>
<li>clipit</li>
<li>pro-audio</li>
<li>obs</li>
<li>ffmpeg</li>
<li>anki</li>
<li>anthy</li>
<li>ledger</li>
<li>mariadb</li>
<li>xclip</li>
<li>brightnessctl</li>
<li>wine-staging</li>
<li>rclone</li>
<li>ppmck</li>
<li>openmpt</li>
<li>fceux</li>
<li>clang</li>
</ul>
</div>
</div>

<div id="outline-container-org22c2d6f" class="outline-3">
<h3 id="org22c2d6f">Setup Fluidsynth daemon</h3>
<div class="outline-text-3" id="text-org22c2d6f">
<p>
<a href="https://wiki.archlinux.org/index.php/FluidSynth#ALSA_daemon_mode">https://wiki.archlinux.org/index.php/FluidSynth#ALSA_daemon_mode</a>
follow this except use <code>pulseaudio</code> as the driver instead of <code>alsa</code>.
start and enable the user service.
and whenever u want to play piano just use <code>aconnect</code> (install <code>alsa-utils</code>) to make the midi port connection from midi controller to fluidsynth.
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Nancy</p>
<p class="date">Created: 2020-12-29 Tue 19:19</p>
</div>
</body>
</html>
